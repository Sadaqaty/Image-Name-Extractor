<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cyberpunk Image Extractor</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <style>
        body,
        html {
            margin: 0;
            padding: 0;
            height: 100%;
            width: 100%;
            background: linear-gradient(135deg, #0f2027 0%, #2c5364 100%);
            font-family: 'Orbitron', 'Courier New', Courier, monospace;
            color: #00ffe7;
        }

        .background {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: -1;
            pointer-events: none;
        }

        .card {
            background: rgba(20, 40, 40, 0.85);
            border-radius: 18px;
            box-shadow: 0 0 40px #00ffe7, 0 0 8px #0ff inset;
            padding: 2rem 2.5rem;
            margin: 3rem auto;
            max-width: 420px;
            text-align: center;
            backdrop-filter: blur(6px);
        }

        h2 {
            font-size: 2.2rem;
            text-shadow: 0 0 12px #00ffe7;
            margin-bottom: 1.2rem;
        }

        .input-group {
            margin-bottom: 1.2rem;
        }

        input[type="file"] {
            background: rgba(0, 255, 231, 0.08);
            border: 2px solid #00ffe7;
            color: #00ffe7;
            padding: 10px;
            border-radius: 8px;
            cursor: pointer;
            width: 100%;
        }

        .drop-zone {
            border: 2px dashed #00ffe7;
            border-radius: 10px;
            padding: 1.2rem;
            margin-bottom: 1rem;
            background: rgba(0, 255, 231, 0.04);
            color: #00ffe7;
            transition: background 0.3s;
        }

        .drop-zone.dragover {
            background: rgba(0, 255, 231, 0.12);
        }

        button {
            background: linear-gradient(90deg, #00ffe7 0%, #0055ff 100%);
            border: none;
            padding: 12px 24px;
            color: #0f2027;
            font-size: 1rem;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            box-shadow: 0 0 10px #00ffe7;
            margin: 0.5rem 0.5rem 0 0;
            transition: background 0.3s;
        }

        button:hover {
            background: linear-gradient(90deg, #0055ff 0%, #00ffe7 100%);
        }

        #downloadLink {
            color: #00ffe7;
            text-decoration: none;
            margin-top: 20px;
            font-size: 1.2rem;
            display: inline-block;
            text-shadow: 0 0 4px #00ffe7;
        }

        .progress-bar {
            width: 100%;
            background: #222;
            border-radius: 8px;
            margin: 1rem 0;
            height: 18px;
            overflow: hidden;
        }

        .progress {
            height: 100%;
            background: linear-gradient(90deg, #00ffe7 0%, #0055ff 100%);
            width: 0;
            transition: width 0.3s;
        }

        .message {
            margin: 1rem 0;
            font-size: 1rem;
            color: #ff00a6;
            text-shadow: 0 0 6px #ff00a6;
        }

        .image-preview {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            justify-content: center;
            margin: 1rem 0;
        }

        .image-thumb {
            width: 48px;
            height: 48px;
            object-fit: cover;
            border-radius: 6px;
            box-shadow: 0 0 8px #00ffe7;
            border: 1px solid #00ffe7;
        }

        @media (max-width: 600px) {
            .card {
                padding: 1rem;
                max-width: 98vw;
            }

            h2 {
                font-size: 1.3rem;
            }
        }
    </style>
</head>

<body>
    <div class="background">
        <!-- Neon grid, animated dots, etc. could go here -->
    </div>
    <div class="card">
        <h2>Cyberpunk Image Name Extractor</h2>
        <div class="input-group">
            <div id="dropZone" class="drop-zone">Drag & Drop ZIP file here or click to select</div>
            <input type="file" id="zipFile" accept=".zip" style="display:none;">
        </div>
        <div>
            <label for="minSize">Min image size (KB):</label>
            <input type="number" id="minSize" value="0" min="0" style="width:60px;">
        </div>
        <button id="extractBtn">Extract Image Names</button>
        <button id="resetBtn" style="display:none;">Reset</button>
        <div class="progress-bar" style="display:none;">
            <div class="progress" id="progress"></div>
        </div>
        <div class="message" id="message"></div>
        <div class="image-preview" id="imagePreview"></div>
        <a id="downloadLink" style="display:none;">Download CSV</a>
    </div>
    <script>
        // UI elements
        const dropZone = document.getElementById('dropZone');
        const fileInput = document.getElementById('zipFile');
        const extractBtn = document.getElementById('extractBtn');
        const resetBtn = document.getElementById('resetBtn');
        const progressBar = document.querySelector('.progress-bar');
        const progress = document.getElementById('progress');
        const message = document.getElementById('message');
        const imagePreview = document.getElementById('imagePreview');
        const downloadLink = document.getElementById('downloadLink');
        let zipFile = null;

        // Drag & drop logic
        dropZone.addEventListener('click', () => fileInput.click());
        dropZone.addEventListener('dragover', e => {
            e.preventDefault();
            dropZone.classList.add('dragover');
        });
        dropZone.addEventListener('dragleave', () => dropZone.classList.remove('dragover'));
        dropZone.addEventListener('drop', e => {
            e.preventDefault();
            dropZone.classList.remove('dragover');
            if (e.dataTransfer.files.length) {
                zipFile = e.dataTransfer.files[0];
                dropZone.textContent = zipFile.name;
            }
        });
        fileInput.addEventListener('change', e => {
            if (e.target.files.length) {
                zipFile = e.target.files[0];
                dropZone.textContent = zipFile.name;
            }
        });

        // Reset logic
        resetBtn.addEventListener('click', () => {
            zipFile = null;
            fileInput.value = '';
            dropZone.textContent = 'Drag & Drop ZIP file here or click to select';
            progressBar.style.display = 'none';
            progress.style.width = '0';
            message.textContent = '';
            imagePreview.innerHTML = '';
            downloadLink.style.display = 'none';
            resetBtn.style.display = 'none';
        });

        // Extraction logic
        extractBtn.addEventListener('click', async () => {
            if (!zipFile) {
                message.textContent = 'Please upload a ZIP file';
                return;
            }
            message.textContent = '';
            imagePreview.innerHTML = '';
            downloadLink.style.display = 'none';
            resetBtn.style.display = 'none';
            progressBar.style.display = 'block';
            progress.style.width = '0';

            const minSizeKB = parseInt(document.getElementById('minSize').value, 10) || 0;
            const jszip = new JSZip();
            try {
                const zip = await jszip.loadAsync(zipFile);
                let imageFiles = [];
                let totalFiles = Object.keys(zip.files).length;
                let processed = 0;

                for (const [relativePath, file] of Object.entries(zip.files)) {
                    processed++;
                    progress.style.width = `${Math.round((processed / totalFiles) * 100)}%`;

                    if (!file.dir && /\.(jpg|jpeg|png|gif|bmp|webp)$/i.test(file.name)) {
                        // Filter by size
                        if (file._data && file._data.uncompressedSize < minSizeKB * 1024) continue;
                        imageFiles.push({
                            name: file.name,
                            path: relativePath,
                            size: file._data ? file._data.uncompressedSize : 0,
                            file
                        });
                    }
                    await new Promise(r => setTimeout(r, 1)); // allow UI update
                }

                if (imageFiles.length === 0) {
                    message.textContent = 'No images found matching criteria.';
                    progressBar.style.display = 'none';
                    resetBtn.style.display = 'block';
                    return;
                }

                // Preview thumbnails (first 10 images)
                imagePreview.innerHTML = '';
                for (let i = 0; i < Math.min(10, imageFiles.length); i++) {
                    const imgData = await imageFiles[i].file.async('blob');
                    const url = URL.createObjectURL(imgData);
                    const img = document.createElement('img');
                    img.src = url;
                    img.className = 'image-thumb';
                    img.title = imageFiles[i].name;
                    imagePreview.appendChild(img);
                }
                if (imageFiles.length > 10) {
                    const more = document.createElement('span');
                    more.textContent = `+${imageFiles.length - 10} more...`;
                    more.style.color = '#00ffe7';
                    more.style.marginLeft = '8px';
                    imagePreview.appendChild(more);
                }

                // CSV: name, path, size (KB)
                const csvRows = ['Image Name,Path,Size (KB)'];
                imageFiles.forEach(img => {
                    csvRows.push(`"${img.name}","${img.path}",${(img.size / 1024).toFixed(1)}`);
                });
                const csvContent = csvRows.join('\n');
                const blob = new Blob([csvContent], { type: 'text/csv' });
                downloadLink.href = URL.createObjectURL(blob);
                downloadLink.download = 'image_names.csv';
                downloadLink.style.display = 'inline-block';
                downloadLink.textContent = 'Download CSV';

                message.textContent = `Found ${imageFiles.length} images.`;
                resetBtn.style.display = 'block';
                progressBar.style.display = 'none';
            } catch (err) {
                console.error('Error reading the ZIP file:', err);
                message.textContent = 'An error occurred while processing the ZIP file';
                progressBar.style.display = 'none';
                resetBtn.style.display = 'block';
            }
        });
    </script>
</body>

</html>